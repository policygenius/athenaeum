#!/bin/bash
set -eo pipefail

echo '+++ Build footer'
NODE_ENV=production yarn run build:footer:styleguide

echo '+++ Deploying footer styleguide latest to S3'
aws s3 sync \
  ./styleguide/footer/build s3://rcl-pg/latest/footer/ \
  --acl=public-read \
  --cache-control max-age=0 \
  --exclude '.DS_Store'

echo "Deployed Footer to http://rcl.policygenius.com/latest/footer/"

NODE_ENV=production yarn run build:publish:footer

echo '+++ Compiling & Building Footer'

aws s3 sync \
  ./footer/build s3://rcl-pg/footer/ \
  --acl=public-read \
  --cache-control max-age=0 \
  --exclude '.DS_Store'

aws s3 sync \
  ./footer/zip s3://rcl-pg/footer/zip/ \
  --acl=public-read \
  --cache-control max-age=0 \
  --content-encoding gzip \
  --exclude '.DS_Store'

echo "Deployed Footer to http://rcl.policygenius.com/footer/"
